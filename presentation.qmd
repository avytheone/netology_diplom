---
title: "–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –æ —Å–µ—Ä–¥–µ—á–Ω–æ-—Å–æ—Å—É–¥–∏—Å—Ç—ã—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è—Ö "
subtitle: "(–ø–æ–∏—Å–∫ –∏–Ω—Å–∞–π—Ç–æ–≤, —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Å—Ç–µ–π–∫—Ö–æ–ª–¥–µ—Ä–∞–º)"
author: "–ê–ª–µ–∫—Å–µ–π –Ø–∫–∏–º–∞–Ω—Å–∫–∏–π"
format:
  revealjs:
    theme: simple
    transition: slide
    slide-number: true
    chalkboard: false
    preview-links: auto
    footer: "Netology DSU-73"
    width: 1920
    height: 1024
jupyter: python3
---

## –í–≤–µ–¥–µ–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞:**  
–°–µ—Ä–¥–µ—á–Ω–æ-—Å–æ—Å—É–¥–∏—Å—Ç—ã–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è (–°–°–ó) ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç–∏. –†–∞–Ω–Ω–µ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–æ–≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ.

**–¶–µ–ª—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:**  
–ê–Ω–∞–ª–∏–∑ —Ñ–∞–∫—Ç–æ—Ä–æ–≤ —Ä–∏—Å–∫–∞ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ ML-–º–æ–¥–µ–ª–µ–π –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è.

**–ó–∞–¥–∞—á–∏:**
1.  –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö (EDA).
2.  –û—á–∏—Å—Ç–∫–∞ –æ—Ç –≤—ã–±—Ä–æ—Å–æ–≤ –∏ –∞–Ω–æ–º–∞–ª–∏–π.
3.  –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π.
4.  –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.

## –°—Ç–µ–π–∫—Ö–æ–ª–¥–µ—Ä—ã

–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≥–æ–¥–æ–ø—Ä–∏–æ–±—Ä–µ—Ç–∞—Ç–µ–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:

::: {.columns}
::: {.column width="50%"}
**üè• –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —É—á—Ä–µ–∂–¥–µ–Ω–∏—è**
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∫—Ä–∏–Ω–∏–Ω–≥–∞
- –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –≤—Ä–∞—á–µ–π
- –¢–æ—á–Ω–æ—Å—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

**üë®‚Äç‚öïÔ∏è –í—Ä–∞—á–∏**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π
- –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤
:::

::: {.column width="50%"}
**üë§ –ü–∞—Ü–∏–µ–Ω—Ç—ã**
- –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –†–∞–Ω–Ω–µ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

**üìâ –°—Ç—Ä–∞—Ö–æ–≤—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏**
- –û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤
- –ü—Ä–µ–≤–µ–Ω—Ç–∏–≤–Ω–∞—è –º–µ–¥–∏—Ü–∏–Ω–∞
:::
:::

## –û–±–∑–æ—Ä –¥–∞–Ω–Ω—ã—Ö

**–ò—Å—Ç–æ—á–Ω–∏–∫:** Cardiovascular Disease Dataset  
**–û–±—ä–µ–º:** 70 000 –∑–∞–ø–∏—Å–µ–π

::: {.columns}
::: {.column width="50%"}
**–ê–Ω—Ç—Ä–æ–ø–æ–º–µ—Ç—Ä–∏—è:**
- `age` (–≤–æ–∑—Ä–∞—Å—Ç)
- `gender` (–ø–æ–ª)
- `height` (—Ä–æ—Å—Ç)
- `weight` (–≤–µ—Å)

**–û–±—Ä–∞–∑ –∂–∏–∑–Ω–∏:**
- `smoke` (–∫—É—Ä–µ–Ω–∏–µ)
- `alco` (–∞–ª–∫–æ–≥–æ–ª—å)
- `active` (—Å–ø–æ—Ä—Ç)
:::

::: {.column width="50%"}
**–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:**
- `ap_hi`, `ap_lo` (–¥–∞–≤–ª–µ–Ω–∏–µ)
- `cholesterol` (—Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω)
- `gluc` (–≥–ª—é–∫–æ–∑–∞)

**–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è:**
- `cardio` (–Ω–∞–ª–∏—á–∏–µ –°–°–ó)
:::
:::

```{python}
#| echo: false
#| warning: false
#| label: setup

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import warnings
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LogisticRegression
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score, roc_auc_score

np.random.seed(31337)
warnings.filterwarnings('ignore')

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
plt.style.use('seaborn-v0_8-whitegrid')
colors = ['#808080', '#606060', '#404040', '#FF6B6B', '#CC5555']
sns.set_palette(colors)
plt.rcParams['font.size'] = 14
plt.rcParams['axes.titlesize'] = 16

# –ó–∞–≥—Ä—É–∑–∫–∞
try:
    df = pd.read_csv('data/cardio_train.csv', sep=';')
except:
    # Fallback creation for demo if file missing in context
    df = pd.DataFrame() 

# –û—á–∏—Å—Ç–∫–∞
df_clean = df.copy()
if not df.empty:
    # –û—á–∏—Å—Ç–∫–∞ –¥–∞–≤–ª–µ–Ω–∏—è
    df_clean = df_clean[
        (df_clean['ap_hi'] >= 70) & (df_clean['ap_hi'] <= 250) &
        (df_clean['ap_lo'] >= 40) & (df_clean['ap_lo'] <= 150) &
        (df_clean['ap_hi'] > df_clean['ap_lo'])
    ]
    # –û—á–∏—Å—Ç–∫–∞ –∞–Ω—Ç—Ä–æ–ø–æ–º–µ—Ç—Ä–∏–∏
    df_clean = df_clean[
        (df_clean['height'] >= 100) & (df_clean['height'] <= 220) &
        (df_clean['weight'] >= 30) & (df_clean['weight'] <= 250)
    ]
    # –í–æ–∑—Ä–∞—Å—Ç
    df_clean['age_years'] = df_clean['age'] / 365.25
    df_clean = df_clean[(df_clean['age_years'] >= 18) & (df_clean['age_years'] <= 100)]
    
    # BMI
    df_clean['bmi'] = df_clean['weight'] / (df_clean['height'] / 100) ** 2
    
    def categorize_bmi(bmi):
        if bmi < 18.5: return '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫'
        elif bmi < 25: return '–ù–æ—Ä–º–∞'
        elif bmi < 30: return '–ò–∑–±—ã—Ç–æ–∫'
        elif bmi < 35: return '–û–∂–∏—Ä–µ–Ω–∏–µ I'
        else: return '–û–∂–∏—Ä–µ–Ω–∏–µ II+'

    df_clean['bmi_category'] = df_clean['bmi'].apply(categorize_bmi)
```

## –ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö –∏ –æ—á–∏—Å—Ç–∫–∞

–í –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –≤—ã–±—Ä–æ—Å—ã (–æ—à–∏–±–∫–∏ –≤–≤–æ–¥–∞):
- –ù–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ (–Ω–∞–ø—Ä. -150)
- –ê–Ω–æ–º–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç/–≤–µ—Å

```{python}
#| echo: false
#| label: outliers-plot
#| layout-ncol: 2
#| fig-subcap: 
#|   - "–î–∞–≤–ª–µ–Ω–∏–µ (–¥–æ –æ—á–∏—Å—Ç–∫–∏)"
#|   - "–†–æ—Å—Ç (–¥–æ –æ—á–∏—Å—Ç–∫–∏)"

if not df.empty:
    plt.figure(figsize=(6, 4))
    sns.boxplot(x=df['ap_hi'], color='#808080')
    plt.title('–í—ã–±—Ä–æ—Å—ã –≤ AP_HI')
    plt.show()

    plt.figure(figsize=(6, 4))
    sns.boxplot(x=df['height'], color='#808080')
    plt.title('–í—ã–±—Ä–æ—Å—ã –≤ Height')
    plt.show()
```


## –¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è

::: {.columns}
::: {.column width="50%"}
```{python}
#| echo: false
#| label: target-dist
#| fig-height: 5

if not df.empty:
    plt.figure(figsize=(8, 5))
    ax = sns.countplot(data=df_clean, x='cardio', palette=['#808080', '#FF6B6B'])
    plt.title('–ë–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤', fontsize=18)
    plt.xlabel('–°–°–ó (0 - –Ω–µ—Ç, 1 - –¥–∞)')
    plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
    
    total = len(df_clean)
    for p in ax.patches:
        percentage = f'{100 * p.get_height() / total:.1f}%'
        ax.annotate(percentage, (p.get_x() + p.get_width() / 2., p.get_height()),
                    ha='center', va='bottom', fontsize=14)
    plt.show()
```
:::

::: {.column width="50%"}
<br>
<br>
**–í—ã–≤–æ–¥:**
–ö–ª–∞—Å—Å—ã –∏–¥–µ–∞–ª—å–Ω–æ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã (~50/50).

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Accuracy –∫–∞–∫ –º–µ—Ç—Ä–∏–∫—É.
2. –ù–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å –º–µ—Ç–æ–¥—ã –æ–≤–µ—Ä—Å–µ–º–ø–ª–∏–Ω–≥–∞.
:::
:::

## –ü–æ—Ä—Ç—Ä–µ—Ç –ø–∞—Ü–∏–µ–Ω—Ç–∞: –ü–æ–ª –∏ –í–æ–∑—Ä–∞—Å—Ç

- **–í–æ–∑—Ä–∞—Å—Ç:** –ú–µ–¥–∏–∞–Ω–∞ ~54 –≥–æ–¥–∞. –ü–∏–∫ —Ä–∏—Å–∫–∞ —Å–º–µ—â–µ–Ω –∫ 60 –≥–æ–¥–∞–º.
- **–ü–æ–ª:** –í –≤—ã–±–æ—Ä–∫–µ –ø—Ä–µ–æ–±–ª–∞–¥–∞—é—Ç –∂–µ–Ω—â–∏–Ω—ã (65%), —á—Ç–æ —Ç–∏–ø–∏—á–Ω–æ –¥–ª—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –æ–±—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –≤ –¥–∞–Ω–Ω–æ–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –≥—Ä—É–ø–ø–µ.

```{python}
#| echo: false
#| label: age-gender
#| layout-ncol: 2

if not df.empty:
    # –ì—Ä–∞—Ñ–∏–∫ 1: –í–æ–∑—Ä–∞—Å—Ç
    plt.figure(figsize=(6, 5))
    sns.histplot(data=df_clean, x='age_years', bins=25, color='#606060', kde=True)
    plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–æ–∑—Ä–∞—Å—Ç–∞')
    plt.xlabel('–õ–µ—Ç')
    plt.show()

    # –ì—Ä–∞—Ñ–∏–∫ 2: –ü–æ–ª
    plt.figure(figsize=(6, 5))
    gender_counts = df_clean['gender'].value_counts()
    # –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º 1-–∂, 2-–º
    labels = ['–ñ–µ–Ω—â–∏–Ω—ã', '–ú—É–∂—á–∏–Ω—ã'] if gender_counts.index[0]==1 else ['–ú—É–∂—á–∏–Ω—ã', '–ñ–µ–Ω—â–∏–Ω—ã']
    plt.pie(gender_counts, labels=labels, autopct='%1.1f%%', colors=['#FF6B6B', '#808080'])
    plt.title('–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ –ø–æ–ª—É')
    plt.show()
```



## –§–∞–∫—Ç–æ—Ä –≤–µ—Å–∞ (BMI)

–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞ ‚Äî –æ–¥–∏–Ω –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤.

::: {.columns}
::: {.column width="50%"}
```{python}
#| echo: false
#| label: bmi-plot
#| fig-height: 5

if not df.empty:
    bmi_counts = df_clean['bmi_category'].value_counts()
    colors_bmi = ['#404040', '#606060', '#808080', '#FF6B6B', '#CC5555']
    
    plt.figure(figsize=(9, 5))
    sns.barplot(x=bmi_counts.index, y=bmi_counts.values, palette=colors_bmi)
    plt.title('–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ BMI')
    plt.ylabel('–ü–∞—Ü–∏–µ–Ω—Ç—ã')
    plt.xticks(rotation=15)
    plt.show()
```
:::

::: {.column width="50%"}
**–ù–∞–±–ª—é–¥–µ–Ω–∏–µ:**
–ú–µ–Ω–µ–µ **40%** –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –∏–º–µ—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –≤–µ—Å.
–ì—Ä—É–ø–ø—ã —Ä–∏—Å–∫–∞ (–∏–∑–±—ã—Ç–æ—á–Ω—ã–π –≤–µ—Å + –æ–∂–∏—Ä–µ–Ω–∏–µ) —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ.
:::
:::

## –û–±—Ä–∞–∑ –∂–∏–∑–Ω–∏ –∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

–í–ª–∏—è–Ω–∏–µ –≤—Ä–µ–¥–Ω—ã—Ö –ø—Ä–∏–≤—ã—á–µ–∫ –∏ —É—Ä–æ–≤–Ω—è –º–µ—Ç–∞–±–æ–ª–∏–∑–º–∞.
- **–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω:** –£ 25% –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ —É—Ä–æ–≤–µ–Ω—å –≤—ã—à–µ –Ω–æ—Ä–º—ã.
- **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** 80% –∑–∞—è–≤–ª—è—é—Ç –æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

```{python}
#| echo: false
#| label: lifestyle
#| layout-ncol: 3

if not df.empty:
    # –•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω
    plt.figure(figsize=(4, 4))
    sns.countplot(x='cholesterol', data=df_clean, palette=['#808080', '#FF6B6B', '#CC5555'])
    plt.title('–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω')
    plt.xlabel('–£—Ä–æ–≤–µ–Ω—å (1-3)')
    plt.ylabel('')
    plt.show()

    # –ö—É—Ä–µ–Ω–∏–µ
    plt.figure(figsize=(4, 4))
    sns.countplot(x='smoke', data=df_clean, palette=['#808080', '#404040'])
    plt.title('–ö—É—Ä–µ–Ω–∏–µ')
    plt.xticks([0, 1], ['–ù–µ—Ç', '–î–∞'])
    plt.xlabel('')
    plt.ylabel('')
    plt.show()
    
    # –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
    plt.figure(figsize=(4, 4))
    sns.countplot(x='active', data=df_clean, palette=['#404040', '#808080'])
    plt.title('–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å')
    plt.xticks([0, 1], ['–ù–µ—Ç', '–î–∞'])
    plt.xlabel('')
    plt.ylabel('')
    plt.show()
```



## –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑

–ö–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã —Å–≤—è–∑–∞–Ω—ã —Å–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ?

::: {.columns}
::: {.column width="50%"}
```{python}
#| echo: false
#| label: heatmap
#| fig-height: 6

if not df.empty:
    df_corr = df_clean.drop(['id', 'age', 'bmi_category'], axis=1)
    corr = df_corr.corr()
    mask = np.triu(np.ones_like(corr, dtype=bool))
    
    plt.figure(figsize=(8, 8))
    sns.heatmap(corr, mask=mask, annot=False, cmap='RdYlBu_r', center=0, cbar_kws={"shrink": .8})
    plt.title('–¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π')
    plt.show()
```
:::

::: {.column width="50%"}
**–ö–ª—é—á–µ–≤—ã–µ —Å–≤—è–∑–∏:**

1.  **Cardio ‚Üî –î–∞–≤–ª–µ–Ω–∏–µ** (—Å–∞–º–∞—è —Å–∏–ª—å–Ω–∞—è —Å–≤—è–∑—å).
2.  **Cardio ‚Üî –í–æ–∑—Ä–∞—Å—Ç**.
3.  **Cardio ‚Üî –í–µ—Å/BMI**.
4.  –°–≤—è–∑—å **Smoke ‚Üî Gender** (–º—É–∂—á–∏–Ω—ã –∫—É—Ä—è—Ç —á–∞—â–µ).

:::
:::

## –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ: –ü–æ–¥—Ö–æ–¥

–î–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –±—ã–ª–∏ –≤—ã–±—Ä–∞–Ω—ã –¥–≤–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞:

1.  **Logistic Regression** (–õ–∏–Ω–µ–π–Ω–∞—è –º–æ–¥–µ–ª—å, –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–∞—è).
2.  **Random Forest** (–ê–Ω—Å–∞–º–±–ª–µ–≤—ã–π –º–µ—Ç–æ–¥, —É–ª–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–µ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç–∏).

**–ü—Ä–æ—Ü–µ—Å—Å:**
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö: 80% Train / 20% Test.
- Stratified Split (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤).
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (StandardScaler).

```{python}
#| echo: false
#| label: modeling-train

if not df.empty:
    X = df_clean.drop(['id', 'age', 'cardio', 'bmi_category'], axis=1)
    y = df_clean['cardio']
    
    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42, stratify=y)
    
    scaler = StandardScaler()
    X_train_scaled = scaler.fit_transform(X_train)
    X_test_scaled = scaler.transform(X_test)
    
    # LR
    lr = LogisticRegression(random_state=42, max_iter=1000)
    lr.fit(X_train_scaled, y_train)
    lr_pred = lr.predict(X_test_scaled)
    lr_acc = accuracy_score(y_test, lr_pred)
    
    # RF
    rf = RandomForestClassifier(n_estimators=100, max_depth=10, random_state=42)
    rf.fit(X_train, y_train)
    rf_pred = rf.predict(X_test)
    rf_acc = accuracy_score(y_test, rf_pred)
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è

–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ (Accuracy) –º–æ–¥–µ–ª–µ–π –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ.

::: {.columns}
::: {.column width="50%"}
```{python}
#| echo: false
#| label: model-res-plot
#| fig-height: 5

if not df.empty:
    res_data = pd.DataFrame({
        'Model': ['Logistic Regression', 'Random Forest'],
        'Accuracy': [lr_acc, rf_acc]
    })
    
    plt.figure(figsize=(8, 5))
    ax = sns.barplot(x='Model', y='Accuracy', data=res_data, palette=['#808080', '#FF6B6B'])
    plt.ylim(0.6, 0.8)
    plt.title('Accuracy Score')
    
    for p in ax.patches:
        ax.annotate(f'{p.get_height():.3f}', (p.get_x() + p.get_width() / 2., p.get_height()),
                    ha='center', va='bottom', fontsize=14, color='black', xytext=(0, 5), textcoords='offset points')
    plt.show()
```
:::

::: {.column width="50%"}
<br>
**Random Forest** –ø–æ–∫–∞–∑–∞–ª –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
**~73.6%**

–≠—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–ª—è —Å–∏—Å—Ç–µ–º –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ —Å–∫—Ä–∏–Ω–∏–Ω–≥–∞ –∏ —Ç—Ä–∏–∞–∂–∞ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤.
:::
:::

## –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–ö–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –º–æ–¥–µ–ª—å Random Forest —Å—á–∏—Ç–∞–µ—Ç —Å–∞–º—ã–º–∏ –≤–∞–∂–Ω—ã–º–∏?

```{python}
#| echo: false
#| label: feature-imp
#| fig-height: 5

if not df.empty:
    importances = rf.feature_importances_
    indices = np.argsort(importances)[::-1]
    features = X.columns
    
    plt.figure(figsize=(10, 5))
    sns.barplot(x=importances[indices], y=features[indices], palette='Reds_r')
    plt.title('Feature Importance (Random Forest)')
    plt.xlabel('–í–µ—Å –ø—Ä–∏–∑–Ω–∞–∫–∞')
    plt.show()
```

1. **–î–∞–≤–ª–µ–Ω–∏–µ (ap_hi)** ‚Äî –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏–π —Ñ–∞–∫—Ç–æ—Ä.
2. **–í–æ–∑—Ä–∞—Å—Ç** ‚Äî –≤—Ç–æ—Ä–æ–π –ø–æ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏.
3. **–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω** ‚Äî –∑–∞–º—ã–∫–∞–µ—Ç —Ç—Ä–æ–π–∫—É –ª–∏–¥–µ—Ä–æ–≤.

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å—Ç–µ–π–∫—Ö–æ–ª–¥–µ—Ä–∞–º

::: {.panel-tabset}

### –î–ª—è –í—Ä–∞—á–µ–π
- –í–Ω–µ–¥—Ä–∏—Ç—å –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∏—Å–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ ML-–º–æ–¥–µ–ª–∏.
- –û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –ø–∞—Ü–∏–µ–Ω—Ç–∞–º —Å BMI > 25 –∏ –≤–æ–∑—Ä–∞—Å—Ç–æ–º > 50.
- –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–∏—Å—Ç–æ–ª–∏—á–µ—Å–∫–æ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è.

### –î–ª—è –ü–∞—Ü–∏–µ–Ω—Ç–æ–≤
- –†–µ–≥—É–ª—è—Ä–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∞–≤–ª–µ–Ω–∏—è (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ñ–∞–∫—Ç–æ—Ä).
- –ö–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Å–∞ (–∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å –¥–∞–≤–ª–µ–Ω–∏–µ–º –∏ –°–°–ó).
- –°–Ω–∏–∂–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω–∞.

### –î–ª—è –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏
- –ü—Ä–µ–¥–ª–∞–≥–∞—Ç—å –ø–∞–∫–µ—Ç–Ω—ã–µ —É—Å–ª—É–≥–∏: "–õ–∏–ø–∏–¥–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å + –ì–ª—é–∫–æ–∑–∞ + –ò–∑–º–µ—Ä–µ–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è".
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–∫–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–æ–≤.

:::

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

1.  **–î–∞–Ω–Ω—ã–µ:** –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ 70 000 –∫–µ–π—Å–æ–≤. –í—ã—è–≤–ª–µ–Ω—ã –∏ —É–¥–∞–ª–µ–Ω—ã –∞–Ω–æ–º–∞–ª–∏–∏.
2.  **–§–∞–∫—Ç–æ—Ä—ã:** –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ –∫–ª—é—á–µ–≤–∞—è —Ä–æ–ª—å **–≥–∏–ø–µ—Ä—Ç–æ–Ω–∏–∏** –∏ **–≤–æ–∑—Ä–∞—Å—Ç–∞**.
3.  **–ú–æ–¥–µ–ª—å:** –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –ø—Ä–æ—Ç–æ—Ç–∏–ø –Ω–∞ –±–∞–∑–µ Random Forest —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é **~73.6%**.
4.  **–í–Ω–µ–¥—Ä–µ–Ω–∏–µ:** –ú–æ–¥–µ–ª—å –≥–æ—Ç–æ–≤–∞ –∫ –ø–∏–ª–æ—Ç–Ω–æ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏–Ω—è—Ç–∏—è –≤—Ä–∞—á–µ–±–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π.

::: {.fragment .fade-up}
<div style="text-align: center; margin-top: 50px; font-size: 1.5em; color: #FF6B6B;">
–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–Ω–∏–º–∞–Ω–∏–µ!
</div>
:::
